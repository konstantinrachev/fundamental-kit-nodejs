
    /*!
    * tiptap-commands v1.2.0
    * (c) 2018 Scrumpy UG (limited liability)
    * @license MIT
    */


!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("prosemirror-commands"),require("prosemirror-schema-list"),require("prosemirror-inputrules"),require("prosemirror-state"),require("prosemirror-model"),require("tiptap-utils")):"function"==typeof define&&define.amd?define(["exports","prosemirror-commands","prosemirror-schema-list","prosemirror-inputrules","prosemirror-state","prosemirror-model","tiptap-utils"],t):t(e.tiptap={},e.prosemirrorCommands,e.prosemirrorSchemaList,e.prosemirrorInputrules,e.prosemirrorState,e.prosemirrorModel,e.tiptapUtils)}("undefined"!=typeof self?self:this,function(e,a,i,t,r,n,p){"use strict";e.chainCommands=a.chainCommands,e.deleteSelection=a.deleteSelection,e.joinBackward=a.joinBackward,e.selectNodeBackward=a.selectNodeBackward,e.joinForward=a.joinForward,e.selectNodeForward=a.selectNodeForward,e.joinUp=a.joinUp,e.joinDown=a.joinDown,e.lift=a.lift,e.newlineInCode=a.newlineInCode,e.exitCode=a.exitCode,e.createParagraphNear=a.createParagraphNear,e.liftEmptyBlock=a.liftEmptyBlock,e.splitBlock=a.splitBlock,e.splitBlockKeepMarks=a.splitBlockKeepMarks,e.selectParentNode=a.selectParentNode,e.selectAll=a.selectAll,e.wrapIn=a.wrapIn,e.setBlockType=a.setBlockType,e.toggleMark=a.toggleMark,e.autoJoin=a.autoJoin,e.baseKeymap=a.baseKeymap,e.pcBaseKeymap=a.pcBaseKeymap,e.macBaseKeymap=a.macBaseKeymap,e.addListNodes=i.addListNodes,e.wrapInList=i.wrapInList,e.splitListItem=i.splitListItem,e.liftListItem=i.liftListItem,e.sinkListItem=i.sinkListItem,e.wrappingInputRule=t.wrappingInputRule,e.textblockTypeInputRule=t.textblockTypeInputRule,e.insertText=function(){var n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";return function(e,t){var r=e.selection.$from.pos.pos;return t(e.tr.insertText(n,r)),!0}},e.markInputRule=function(e,s,u){return new t.InputRule(e,function(e,t,r,n){var o=u instanceof Function?u(t):u,i=e.tr,a=n;if(t[1]){var p=t[0].search(/\S/),l=r+t[0].indexOf(t[1]),c=l+t[1].length;c<n&&i.delete(c,n),r<l&&i.delete(r+p,l),a=r+p+t[1].length}return i.addMark(r,a,s.create(o)),i.removeStoredMark(s),i})},e.pasteRule=function(c,s,u){return new r.Plugin({props:{transformPasted:function(e){return new n.Slice(function p(e){var l=[];return e.forEach(function(e){if(e.isText){var t,r=e.text,n=0;do{if(t=c.exec(r)){var o=t.index,i=o+t[0].length,a=u instanceof Function?u(t[0]):u;0<o&&l.push(e.cut(n,o)),l.push(e.cut(o,i).mark(s.create(a).addToSet(e.marks))),n=i}}while(t);n<r.length&&l.push(e.cut(n))}else l.push(e.copy(p(e.content)))}),n.Fragment.fromArray(l)}(e.content),e.openStart,e.openEnd)}}})},e.removeMark=function(i){return function(e,t){var r=e.selection,n=r.from,o=r.to;return t(e.tr.removeMark(n,o,i))}},e.replaceText=function(){var l=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,c=1<arguments.length?arguments[1]:void 0,s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return function(e,t){var r=e.selection,n=r.$from,o=r.$to,i=n.index(),a=l?l.from:n.pos,p=l?l.to:o.pos;return!!n.parent.canReplaceWith(i,i,c)&&(t&&t(e.tr.replaceWith(a,p,c.create(s))),!0)}},e.setInlineBlockType=function(o){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return function(e,t){var r=e.selection.$from,n=r.index();return!!r.parent.canReplaceWith(n,n,o)&&(t&&t(e.tr.replaceSelectionWith(o.create(i))),!0)}},e.splitToDefaultListItem=function(m){return function(e,t){var r=e.selection,n=r.$from,o=r.$to,i=r.node;if(i&&i.isBlock||n.depth<2||!n.sameParent(o))return!1;var a=n.node(-1);if(a.type!=m)return!1;if(0==n.parent.content.size){if(2==n.depth||n.node(-3).type!=m||n.index(-2)!=n.node(-2).childCount-1)return!1;if(t){for(var p=Fragment.empty,l=0<n.index(-1),c=n.depth-(l?1:2);c>=n.depth-3;c--)p=Fragment.from(n.node(c).copy(p));p=p.append(Fragment.from(m.createAndFill()));var s=e.tr.replace(n.before(l?null:-1),n.after(-3),new Slice(p,l?3:2,2));s.setSelection(e.selection.constructor.near(s.doc.resolve(n.pos+(l?3:2)))),t(s.scrollIntoView())}return!0}var u=o.pos==n.end()?a.contentMatchAt(n.indexAfter(-1)).defaultType:null,d=e.tr.delete(n.pos,o.pos),f=u&&[{type:m},{type:u}];return f||(f=[{type:m},null]),!!function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,n=3<arguments.length?arguments[3]:void 0,o=e.resolve(t),i=o.depth-r,a=n&&n[n.length-1]||o.parent;if(i<0||o.parent.type.spec.isolating||!o.parent.canReplace(o.index(),o.parent.childCount)||!a.type.validContent(o.parent.content.cutByIndex(o.index(),o.parent.childCount)))return!1;for(var p=o.depth-1,l=r-2;i<p;p--,l--){var c=o.node(p),s=o.index(p);if(c.type.spec.isolating)return!1;var u=c.content.cutByIndex(s,c.childCount),d=n&&n[l]||c;if(d!=c&&(u=u.replaceChild(0,d.type.create(d.attrs))),!c.canReplace(s+1,c.childCount))return!1}var f=o.indexAfter(i),m=n&&n[0];return o.node(i).canReplaceWith(f,f,m?m.type:o.node(i+1).type)}(d.doc,n.pos,2,f)&&(t&&t(d.split(n.pos,2,[{type:e.schema.nodes.todo_item,attrs:{done:!1}}]).scrollIntoView()),!0)}},e.toggleBlockType=function(n,o){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return function(e,t,r){return p.nodeIsActive(e,n,i)?a.setBlockType(o)(e,t,r):a.setBlockType(n,i)(e,t,r)}},e.toggleList=function(n,o){return function(e,t,r){return p.nodeIsActive(e,n)?i.liftListItem(o)(e,t,r):i.wrapInList(n)(e,t,r)}},e.toggleWrap=function(n){return function(e,t,r){return p.nodeIsActive(e,n)?a.lift(e,t):a.wrapIn(n)(e,t,r)}},e.updateMark=function(i,a){return function(e,t){var r=e.selection,n=r.from,o=r.to;return t(e.tr.addMark(n,o,i.create(a)))}},Object.defineProperty(e,"__esModule",{value:!0})});